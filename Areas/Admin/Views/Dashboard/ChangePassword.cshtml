@model HMSCore.Areas.Admin.Models.ChangePasswordViewModel
@{
    ViewData["Title"] = "Change Password";
    Layout = "~/Areas/Admin/Views/Shared/_Layout.cshtml";
}

<section class="content-header">
    <h1>Change Password</h1>
    <ol class="breadcrumb">
        <li><a href="/Admin/Dashboard/Index"><i class="fa fa-home"></i> Setting</a></li>
        <li class="active">Change Password</li>
    </ol>
</section>

<section class="content">
    <div class="box">
        <div class="box-body">

            <div class="form-body">
                <div class="col-sm-12" style="margin-top:30px;">
                    <div class="col-sm-4"></div>
                    <div class="col-sm-5" style="background: aliceblue;">
                        <div class="row">
                            <div class="col-sm-12" style="background:#3c8dbc; color:white; text-align:center;">
                                <h2 class="intro-text text-center text-uppercase"><span style="color:white; font-size:25px;">CHANGE</span><span style="font-size: 25px;"> PASSWORD!</span></h2>
                            </div>
                        </div>
                        <br />
            <form asp-action="ChangePassword" method="post">

                <div class="input-group mb-3">
                    <span class="input-group-addon toggle-password">
                        <i class="fa fa-eye"></i>
                    </span>
                <input autocomplete="off"  asp-for="CurrentPassword" class="form-control" placeholder="Current Password" />
                 <span asp-validation-for="CurrentPassword" class="text-danger"></span>
                </div>
                            <br />
                <div class="input-group mb-3">
                    <span class="input-group-addon toggle-password">
                        <i class="fa fa-eye"></i>
                    </span>
                    <input autocomplete="off" asp-for="NewPassword" class="form-control" placeholder="New Password" />
                                <span asp-validation-for="NewPassword" class="text-danger"></span>
                </div>
                            <br />
                <div class="input-group mb-3">
                    <span class="input-group-addon toggle-password">
                        <i class="fa fa-eye"></i>
                    </span>
                 <input autocomplete="off" asp-for="ConfirmPassword" class="form-control" placeholder="Confirm Password" />
                                <span asp-validation-for="ConfirmPassword" class="text-danger"></span>
                </div>
                            <br />
                <div class="text-center">
                 <button type="submit" class="BTN  btn btn-primary">Change Password</button>
                  <a asp-action="Index" class="BTN  btn btn-primary">Cancel</a>
                </div>

            </form>
        </div>
        </div>
        </div>
        </div>
    </div>
</section>
@section Scripts {
<script>
    document.querySelectorAll(".toggle-password").forEach(btn => {
        btn.addEventListener("click", function () {
            let input = this.parentElement.querySelector("input");
            let icon = this.querySelector("i");

            if (input.type === "password") {
                input.type = "text";
                icon.classList.replace("fa-eye", "fa-eye-slash");
            } else {
                input.type = "password";
                icon.classList.replace("fa-eye-slash", "fa-eye");
            }
        });
    });
</script>
    <script>
        // Remove red border while typing
        document.querySelectorAll("[name='NewPassword'], [name='ConfirmPassword']")
            .forEach(input => {
                input.addEventListener("input", function () {
                    this.style.border = "";
                });
            });

        // Prevent submit if passwords don't match
        document.querySelector("form").addEventListener("submit", function (e) {

            let newPass = document.querySelector("[name='NewPassword']").value;
            let confirmPass = document.querySelector("[name='ConfirmPassword']").value;

            if (newPass !== confirmPass) {
                e.preventDefault(); // 🚫 NO POST → NO REFRESH

                alert("New Password and Confirm Password do not match.");

                document.querySelector("[name='NewPassword']").style.border = "1px solid red";
                document.querySelector("[name='ConfirmPassword']").style.border = "1px solid red";
            }
        });
    </script>

}